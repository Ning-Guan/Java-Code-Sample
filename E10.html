<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>水果购买清单</title>
<script src="js/jquery-1.8.3.min.js"></script>
<script>

$(function(){
	function checkName(){
		var status=true;
		$("input[name='name']").each(function() {
			if($(this).val()==""){
				alert("水果名字不能为空");
				status=false;
			}
            
        });
		return status 
	};
	
	function checkPrice(){
		var status=true;
		$("input[name='price']").each(function() {
			if($(this).val()==""){
				alert("水果价格不能为空");
				status=false;
			}
			else if(!Number($(this).val())){
				alert("水果价格需要为数字");
				status=false;
				
			}
            
        });
		return status 
	};
	
	function total(){
		
		$("input[value='编辑']").each(function() {
			
			var eachPrice = $(this).parents("tr").find("td:eq(1)").val();
			alert(eachPrice);
			total += eachPrice;
			alert(total);
            
        });
		$("input[id='amount']").html("总价："+total);
		
		/*
		var total = 0;
		var length=$("table:tr").length;
		for(var i=2;i<length-2;i++){
			total += parseInt();
		}
		*/
		
	};
	
	
	$("input[value='添加']").click(function(){
		
		if(checkName()&&checkPrice()){
		var newTr = "<tr>"+
    "<td align='center'>"+
      "<input type='text' name='name' /></td>"+
    "<td align='center'>"+
     " <input type='text' name='price'/></td>"+
    "<td align='center'><input type='button' value='保存' /></td>"+
    "<td align='center'><input type='checkbox' name='checkbox' /></td>"
	+"</tr>";
		
	$("table tr:last").before(newTr);
		}
		
		});
		
		
	$("input[value='保存']").live("click",function(){
		if(checkName()&&checkPrice()){
			var name=$(this).parents("tr").find("td:eq(0) input").val();
			var price=$(this).parents("tr").find("td:eq(1) input").val();
			$(this).parents("tr").find("td:eq(0)").html(name);
			$(this).parents("tr").find("td:eq(1)").html(price);
			$(this).parents("tr").find("td:eq(2)").html("<input type='button' value='编辑' />");
		}
			
		});
	

	$("input[value='编辑']").live("click",function(){
		var name=$(this).parents("tr").find("td:eq(0)").html();
		//alert(name);
		var price=$(this).parents("tr").find("td:eq(1)").html();	
		//alert(price);
		$(this).parents("tr").find("td:eq(0)").html("<input type='text' name='name' value="+name+">");
		$(this).parents("tr").find("td:eq(1)").html("<input type='text' name='price' value="+price+">");
		$(this).parents("tr").find("td:eq(2)").html("<input type='button' value='保存' />");

		});
		
		
	$("input[value='删除']").click(function(){
		if(!confirm("是否确认删除")){return;};
		$("input[type='checkbox']").each(function() {
			if($(this).attr("checked")=="checked"){
				$(this).parents("tr").remove();
			}
            
			total();
        });
		
		
		
		});
		
	
});


</script>
</head>

<body>
<form id="form1" name="form1" method="post" action="">
<table width="621" border="1">
  <tr>
    <td colspan="4" align="center">水果购买清单</td>
  </tr>
  <tr>
    <td width="209" align="center">水果名称</td>
    <td width="216" align="center">水果价格</td>
    <td width="83" align="center">
      <input type="button" name="button" value="添加" />
    </td>
    <td width="85" align="center"><input type="button" name="button2" value="删除" /></td>
  </tr>
<!--  <tr>
    <td align="center">
      <input name="name"  /></td>
    <td align="center">
      <input name="price" /></td>
    <td><input type="button" value="保存" /></td>
    <td><input type="checkbox" name="checkbox"/></td>
  </tr>-->
  <tr>
    <td colspan="4" align="center" id="amount">总价：</td>
    </tr>
</table>
</form>
</body>
</html>
